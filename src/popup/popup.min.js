const closeMenu=()=>{$("#menuDiv").slideUp({duration:500,easing:"easeOutQuint"})&&$("#tabler-menu").fadeOut(()=>{$("#tabler-menu").html('\n                <svg class="tabler-icon">\n                    <use xlink:href="../../icons/tabler-sprite-nostroke.svg#tabler-adjustments" />\n                </svg>\n            '),$("#tabler-menu").fadeIn()})},openMenu=()=>{$("#menuDiv").slideDown({duration:500,easing:"easeOutQuint"})&&$("#tabler-menu").fadeOut(()=>{$("#tabler-menu").html('\n        <svg class="tabler-icon menu-svg">\n            <use xlink:href="../../icons/tabler-sprite-nostroke.svg#tabler-circle-x" />\n        </svg>\n    '),$("#tabler-menu").fadeIn()})},main=e=>{var t=null,o=!1;const c=()=>{try{clearTimeout(t),$("#feedback-notif").remove(),o=!0}catch(e){console.log("No feedback to remove.")}$("#menuDiv").append('\n            <div id="check-feedback">\n                <svg class="tabler-icon">\n                    <use xlink:href="../../icons/tabler-sprite-nostroke.svg#tabler-floppy-disk" />\n                </svg>\n            </div>\n        '),$("#check-feedback").animate({right:"12px",opacity:"1"},300,"easeInOutBack"),t=setTimeout(()=>{$("#check-feedback").animate({right:"-100px",opacity:"0"},300,"easeInOutBack",()=>{!o&&$("#check-feedback").remove(),o=!1})},1500)},n=parseUrl(e.url);$("#helpGithubLink").click(()=>{chrome.tabs.update({url:"https://github.com/vict0rsch/ArxivTools"})}),$("#coblock").click(()=>{chrome.tabs.update({url:"https://marketplace.visualstudio.com/items?itemName=vict0rsch.coblock"})}),$("#tabler-menu").click(()=>{state.menuIsOpen?closeMenu():openMenu(),state.menuIsOpen=!state.menuIsOpen}),$("#memory-switch").click(()=>{state.memoryIsOpen?closeMemory():openMemory(),state.memoryIsOpen=!state.memoryIsOpen}),$("#download-arxivmemory").click(()=>{const e=(new Date).toLocaleString();chrome.storage.local.get("papers",({papers:t})=>{downloadTextFile(JSON.stringify(t),`arxiv-memory-${e}.json`,"text/json")})});const a=["checkBib","checkMd","checkDownload","checkPdfTitle","checkVanity","checkMemory"];chrome.storage.local.get(a,function(e){const t={};for(const o of a)t[o]=e.hasOwnProperty(o);const o={};for(const c of a)o[c]=!t[c]||e[c];chrome.storage.local.set(o,function(){chrome.storage.local.get(a,function(e){for(const c of a)$("#"+c).prop("checked",e[c]),o[c]=!t[c]||e[c]})});for(const e of a)$("#"+e).change(function(){const t=this.checked;chrome.storage.local.set({[e]:t},function(){c(),console.log(`Settings saved for ${e} (${t})`)})});if("arxiv.org"===n.hostname&&($("#notArxiv").hide(),$("#notPdf").show(),$("#bibtex-card-content").slideUp(),n.href.endsWith(".pdf"))){$("#notPdf").hide(),$("#isArxiv").show();const e=n.href.split("/").reverse()[0].replace(".pdf",""),t="https://arxiv.org/abs/"+e;$("#goToAbstract").text(e),$("#abstract-card").click(e=>{chrome.tabs.update({url:t}),window.close()}),$.get(`https://export.arxiv.org/api/query?id_list=${e}`).then(e=>{const{bibvars:t,bibtext:o}=parseArxivBibtex(e);$("#abstract-card-title").text(t.title),$("#bibtex-card-content").text(o),$("#bibtex-card-header").click(e=>{copyTextToClipboard($("#bibtex-card-content").text()),$("#bibtex-svg").fadeOut(()=>{$("#clipboard-ok").fadeIn(()=>{setTimeout(()=>{$("#clipboard-ok").fadeOut(()=>{$("#bibtex-svg").fadeIn()})},1500)})})})})}})};$(()=>{chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(e){e[0].url;main(e[0])})});