function delay(e,t){let n=0;return function(...r){clearTimeout(n),n=setTimeout(e.bind(this,...r),t||0)}}function fallbackCopyTextToClipboard(e){var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{var n=document.execCommand("copy"),r=n?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+r)}catch(e){console.error("Fallback: Oops, unable to copy",e)}document.body.removeChild(t)}function copyTextToClipboard(e){navigator.clipboard?navigator.clipboard.writeText(e).then(function(){console.log("Async: Copying to clipboard was successful!")},function(e){console.error("Async: Could not copy text: ",e)}):fallbackCopyTextToClipboard(e)}function parseUrl(e){var t=document.createElement("a");return t.href=e,t}$.easing.jswing=$.easing.swing,$.extend($.easing,{def:"easeOutQuad",swing:function(e,t,n,r,a){return $.easing[$.easing.def](e,t,n,r,a)},easeInQuad:function(e,t,n,r,a){return r*(t/=a)*t+n},easeOutQuad:function(e,t,n,r,a){return-r*(t/=a)*(t-2)+n},easeInOutQuad:function(e,t,n,r,a){return(t/=a/2)<1?r/2*t*t+n:-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,a){return r*(t/=a)*t*t+n},easeOutCubic:function(e,t,n,r,a){return r*((t=t/a-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,a){return(t/=a/2)<1?r/2*t*t*t+n:r/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,r,a){return r*(t/=a)*t*t*t+n},easeOutQuart:function(e,t,n,r,a){return-r*((t=t/a-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,r,a){return(t/=a/2)<1?r/2*t*t*t*t+n:-r/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,r,a){return r*(t/=a)*t*t*t*t+n},easeOutQuint:function(e,t,n,r,a){return r*((t=t/a-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,r,a){return(t/=a/2)<1?r/2*t*t*t*t*t+n:r/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,r,a){return-r*Math.cos(t/a*(Math.PI/2))+r+n},easeOutSine:function(e,t,n,r,a){return r*Math.sin(t/a*(Math.PI/2))+n},easeInOutSine:function(e,t,n,r,a){return-r/2*(Math.cos(Math.PI*t/a)-1)+n},easeInExpo:function(e,t,n,r,a){return 0==t?n:r*Math.pow(2,10*(t/a-1))+n},easeOutExpo:function(e,t,n,r,a){return t==a?n+r:r*(1-Math.pow(2,-10*t/a))+n},easeInOutExpo:function(e,t,n,r,a){return 0==t?n:t==a?n+r:(t/=a/2)<1?r/2*Math.pow(2,10*(t-1))+n:r/2*(2-Math.pow(2,-10*--t))+n},easeInCirc:function(e,t,n,r,a){return-r*(Math.sqrt(1-(t/=a)*t)-1)+n},easeOutCirc:function(e,t,n,r,a){return r*Math.sqrt(1-(t=t/a-1)*t)+n},easeInOutCirc:function(e,t,n,r,a){return(t/=a/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+n:r/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,r,a){var o=1.70158,i=0,s=r;if(0==t)return n;if(1==(t/=a))return n+r;if(i||(i=.3*a),s<Math.abs(r)){s=r;o=i/4}else o=i/(2*Math.PI)*Math.asin(r/s);return-s*Math.pow(2,10*(t-=1))*Math.sin((t*a-o)*(2*Math.PI)/i)+n},easeOutElastic:function(e,t,n,r,a){var o=1.70158,i=0,s=r;if(0==t)return n;if(1==(t/=a))return n+r;if(i||(i=.3*a),s<Math.abs(r)){s=r;o=i/4}else o=i/(2*Math.PI)*Math.asin(r/s);return s*Math.pow(2,-10*t)*Math.sin((t*a-o)*(2*Math.PI)/i)+r+n},easeInOutElastic:function(e,t,n,r,a){var o=1.70158,i=0,s=r;if(0==t)return n;if(2==(t/=a/2))return n+r;if(i||(i=a*(.3*1.5)),s<Math.abs(r)){s=r;o=i/4}else o=i/(2*Math.PI)*Math.asin(r/s);return t<1?s*Math.pow(2,10*(t-=1))*Math.sin((t*a-o)*(2*Math.PI)/i)*-.5+n:s*Math.pow(2,-10*(t-=1))*Math.sin((t*a-o)*(2*Math.PI)/i)*.5+r+n},easeInBack:function(e,t,n,r,a,o){return null==o&&(o=1.70158),r*(t/=a)*t*((o+1)*t-o)+n},easeOutBack:function(e,t,n,r,a,o){return null==o&&(o=1.70158),r*((t=t/a-1)*t*((o+1)*t+o)+1)+n},easeInOutBack:function(e,t,n,r,a,o){return null==o&&(o=1.70158),(t/=a/2)<1?r/2*(t*t*((1+(o*=1.525))*t-o))+n:r/2*((t-=2)*t*((1+(o*=1.525))*t+o)+2)+n},easeInBounce:function(e,t,n,r,a){return r-$.easing.easeOutBounce(e,a-t,0,r,a)+n},easeOutBounce:function(e,t,n,r,a){return(t/=a)<1/2.75?r*(7.5625*t*t)+n:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+n:r*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(e,t,n,r,a){return t<a/2?.5*$.easing.easeInBounce(e,2*t,0,r,a)+n:.5*$.easing.easeOutBounce(e,2*t-a,0,r,a)+.5*r+n}});const cleanPapers=e=>{let t={...e};return delete t.__dataVersion,t},downloadTextFile=(e,t,n)=>{var r=document.createElement("a"),a=new Blob([e],{type:n});r.href=URL.createObjectURL(a),r.download=t,r.click()},eventId=e=>{const t=$(e.target),n=t.closest(".memory-item-container").attr("id").split("--")[1],r=n.replace(".","\\.");return{id:n,eid:r}},download_file=(e,t)=>{if(window.ActiveXObject){if(window.ActiveXObject&&document.execCommand){var n=window.open(e,"_blank");n.document.close(),n.document.execCommand("SaveAs",!0,t||e),n.close()}}else{var r=document.createElement("a");r.href=e,r.target="_blank";var a=e.substring(e.lastIndexOf("/")+1);if(r.download=t||a,navigator.userAgent.toLowerCase().match(/(ipad|iphone|safari)/)&&navigator.userAgent.search("Chrome")<0)document.location=r.href;else{var o=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});r.dispatchEvent(o),(window.URL||window.webkitURL).revokeObjectURL(r.href)}}},defaultPDFTitleFn=(e,t)=>(e=e.replaceAll("\n"," ").replace(/\s\s+/g," "),`${e} - ${t}.pdf`),getPdfFn=code=>{try{pdfTitleFn=eval(code)}catch(e){console.log("Error parsing pdf title function. Function string then error:"),console.log(code),console.log(e),pdfTitleFn=defaultPDFTitleFn}try{pdfTitleFn("test","1.2")}catch(e){console.log("Error testing the user's pdf title function. Function string then error:"),console.log(code),console.log(e),pdfTitleFn=defaultPDFTitleFn}return pdfTitleFn},migrateData=async(e,t)=>{const n=e.__dataVersion||1;var r=[];try{if(e.hasOwnProperty("__dataVersion")&&e.__dataVersion===t)return e;backupData(e),delete e.__dataVersion;for(const t in e)if(n<5&&(e[t].hasOwnProperty("bibtext")||(e[t].bibtext="",console.log("Migrating bibtext for "+t)),e[t].pdfLink.endsWith(".pdf")||(e[t].pdfLink=e[t].pdfLink+".pdf"),e[t].codeLink||(e[t].codeLink=""),e[t].source||(e[t].id.includes("NeurIPS")?e[t].source="neurips":e[t].source="arxiv")),n<208&&("arxiv"!==e[t].source&&e[t].md.includes("https://arxiv.com/abs/")&&(e[t].md=`[${e[t].title}](${e[t].pdfLink})`),"arxiv"!==e[t].source&&e[t].pdfLink.includes("arxiv.org/pdf/")&&(e[t].source="arxiv"),t.match(/^\d/)&&"arxiv"===e[t].source)){const n=`Arxiv-${t}`;let a={...e[t],id:n};e[n]=a,r.push(t)}r.forEach((t,n)=>{delete e[t],console.log("Deleting "+t)});let a={...e};return a.__dataVersion=t,chrome.storage.local.set({papers:a},()=>{console.log("Migrated papers:"),console.log(a),console.log("Data version is now "+t)}),a}catch(r){return console.log(`Error migrating data from version ${n} to ${t}: `),console.log(r),e}},backupData=e=>{chrome.local.storage.get("papersBackup",({papersBackup:t})=>{void 0===t&&(t={});const n=Object.keys(t).map(e=>parseInt(e)).sort((e,t)=>e<t?1:-1).slice(4);for(const e of n)delete t[e];t[t.__dataVersion]=e,chrome.storage.local.set({papersBackup:t},()=>{console.log("Backed up data with version: "+e.__dataVersion)})})};var state={menuIsOpen:!1,memoryIsOpen:!1,papers:{},papersList:[],sortedPapers:[],sortKey:"",paperTags:new Set,dataVersion:0,pdfTitleFn:defaultPDFTitleFn};const statePdfTitle=(e,t)=>{let n;try{n=state.pdfTitleFn(e,t)}catch(r){n=defaultPDFTitleFn(e,t)}return n.replaceAll("\n"," ").replace(/\s\s+/g," ")},manifestDataVersion=()=>{const e=chrome.runtime.getManifest();return e.version.split(".").map((e,t)=>parseInt(e)*10**(4-2*t)).reduce((e,t)=>e+t)},initState=async(e,t)=>{if(console.log("Found papers:"),console.log(e),state.dataVersion=manifestDataVersion(),e=await migrateData(e,state.dataVersion),t)return e;state.papers=e,state.papersList=Object.values(cleanPapers(e)),state.sortKey="lastOpenDate",sortMemory(),makeTags()};hashCode=function(e){return e.split("").reduce(function(e,t){return e=(e<<5)-e+t.charCodeAt(0),e&e},0)};const parseCVFUrl=e=>{const t=e.replace("https://openaccess.thecvf.com/content","").slice(1).split("/")[0].split("_");let n,r;1===t.length?(n=t[0].slice(0,-4),r=t[0].slice(-4)):(n=t[0].toUpperCase(),r=t[1]);const a=e.split("/").reverse()[0].split(".")[0],o=(hashCode(a)+"").replace("-","").slice(0,8),i=`${n}-${r}_${o}`;return{conf:n,year:r,id:i}},isPaper=e=>{const t=parseUrl(e);let n={arxiv:!1,neurips:!1,cvf:!1};return"arxiv.org"===t.hostname&&(t.pathname.startsWith("/abs/")||t.pathname.startsWith("/pdf/"))&&(n.arxiv=!0),"proceedings.neurips.cc"===t.hostname&&(n.neurips=t.pathname.startsWith("/paper/")),"openaccess.thecvf.com"===t.hostname&&(t.pathname.startsWith("/content/")||t.pathname.startsWith("/content_"))&&(n.cvf=!0),n},parseIdFromUrl=e=>{const t=isPaper(e);if(t.arxiv){const t=e.split("/").reverse()[0].replace(".pdf","").split("v")[0];return`Arxiv-${t}`}if(t.neurips){const t=e.split("/paper/")[1].split("/")[0],n=e.split("/").reverse()[0].split("-")[0].slice(0,8);return`NeurIPS-${t}_${n}`}if(t.cvf)return parseCVFUrl(e).id;throw Error("unknown paper url")},handlePopupKeydown=e=>{if([8,13,27,65,69].indexOf(e.which)<0)return;if(state.menuIsOpen)return void(27===e.which&&(e.preventDefault(),closeMenu()));if(!state.memoryIsOpen){if(65==e.which){if($(":focus").length)return;$("#memory-switch").click()}else if(13==e.which){let e=$("#memory-switch-text-on:focus").first();if(e.length>0)return void $("#memory-switch").click();if(e=$("#tabler-menu:focus").first(),e.length>0)return $("#tabler-menu").click(),void $("#tabler-menu").blur()}return}let t,n;const r=$(".memory-item-container:focus").first();if(27!==e.which){if(1!==r.length)return;t=r.attr("id").split("--")[1],n=t.replace(".","\\.")}8===e.which?findEl(n,"delete-memory-item").click():13===e.which?findEl(n,"memory-item-link").click():27===e.which?(e.preventDefault(),closeMemory()):69===e.which&&findEl(n,"memory-item-edit").click()},formatBibtext=e=>{let t=$.trim(e).split("\n").join("");const n=t.match(/\w+\ ?=/g);if(n)for(const e of n)t=t.replace(e,`\n  ${e}`);return"}}"===t.slice(-2)&&(t=t.slice(0,-1)+"\n}"),t};