String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};const firstNonStopLowercase=t=>{let e=t.toLowerCase(),r=e.split(" ").map(t=>t.replace(/[^0-9a-z]/gi,"")),a=r.filter(t=>englishStopWords.has(t));return a.length>0?a[0]:r[0]},parseArxivBibtex=t=>{var e=$(t),r=[],a="";e.find("author name").each((t,e)=>{r.push($(e).text()),0===t&&(a+=$(e).text().split(" ")[$(e).text().split(" ").length-1].toLowerCase())});var i="";e.find("link").each((t,e)=>{const r=$(e).attr("href");r&&r.indexOf("arxiv.org/pdf/")>=0&&(i=r)});const n=r.join(" and "),s=$(e.find("entry title")[0]).text(),c=$(e.find("entry published")[0]).text().slice(0,4);let l;a+=c,a+=firstNonStopLowercase(s);const o=e.find("id");o.each((t,e)=>{$(e).html().match(/\d\d\d\d\.\d\d\d\d\d/g)&&(l=$(e).html().match(/\d\d\d\d\.\d\d\d\d\d/g)[0])}),l=`Arxiv-${l}`;const p={key:a,title:s,author:n,year:c,id:l,pdfLink:i};let d="";return d+=`@article{${a}, \n`,d+=`    title = { ${s} }, \n`,d+=`    author = { ${n} }, \n`,d+=`    year = { ${c}}, \n`,d+=`    journal = { arXiv preprint arXiv: ${l}}\n`,d+="}",{bibvars:p,bibtext:d}},parseNeuripsHTML=(t,e)=>{const r=(new DOMParser).parseFromString(e.replaceAll("\n",""),"text/html"),a=$(r),i=a.find(".container-fluid .col p"),n=t.split("/").slice(-1)[0].replace("-Paper.pdf",""),s=a.find("h4").first().text(),c=$(i[1]).text().split(", ").map((t,e)=>{const r=t.split(" "),a=r.map((t,e)=>t.capitalize());return a.join(" ")}).join(" and "),l=t,o=$(i[0]).text().match(/\d{4}/)[0],p=`neurips${o}${n.slice(0,8)} `,d=`NeurIPS - ${o}_${n.slice(0,8)} `,h=`\n@inproceedings{NEURIPS${o}_${n.slice(0,8)}\n    author = { ${c}\n},\nbooktitle = { Advances in Neural Information Processing Systems },\n    editor = { H.Larochelle and M.Ranzato and R.Hadsell and M.F.Balcan and H.Lin },\n    publisher = { Curran Associates, Inc.},\n    title = { ${s}},\nurl = { ${t}},\nyear = { ${o}}\n}`;return{key:p,title:s,author:c,year:o,id:d,pdfLink:l,bibtext:h}},parseCvfHTML=(t,e)=>{const r=(new DOMParser).parseFromString(e.replaceAll("\n",""),"text/html"),a=$(r),i=$.trim(a.find("#papertitle").text());let n=a.find("#authors i").first().text();n=n.split(",").map(t=>$.trim(t)).join(" and ");const{year:s,id:c,conf:l}=parseCVFUrl(t);let o="";t.endsWith(".pdf")?o=t:a.find("a").each((t,e)=>{if("pdf"===$(e).text()){let t=$(e).attr("href");t.startsWith("../")&&(t=t.replaceAll("../","")),t.startsWith("/")||(t="/"+t),o="http://openaccess.thecvf.com"+t}});const p=a.find(".bibref").first().text().replaceAll(",  ",",\n  "),d=p.split("{")[1].split(",")[0];return{key:d,title:i,author:n,year:s,id:c,pdfLink:o,bibtext:p,conf:l}},fetchArxivBibtex=async t=>$.get(`https://export.arxiv.org/api/query?id_list=${t}`),fetchNeuripsHTML=async t=>{let e;return e=t.endsWith(".pdf")?t.replace("/file/","/hash/").replace("-Paper.pdf","-Abstract.html"):t,fetch(e).then(t=>t.text())},fetchCvfHTML=async t=>{let e,r;if(e=t.endsWith(".pdf")?t.replace("/papers/","/html/").replace(".pdf",".html"):t,r=await fetch(e).then(t=>t.ok?t.text():""),!r&&e.includes("thecvf.com/content_")){const{conf:a,year:i}=parseCVFUrl(t);e=e.replace(`/content_${a}_${i}/`,`/content_${a.toLowerCase()}_${i}/`),r=await fetch(e).then(t=>t.ok?t.text():"")}return r},fetchOpts={headers:{mode:"no-cors"}},fetchPWCId=async(t,e)=>{let r="https://paperswithcode.com/api/v1/papers/?";t?r+=new URLSearchParams({arxiv_id:t}):e&&(r+=new URLSearchParams({title:e}));const a=await $.getJSON(r);if(console.log({json:a}),1===a.count)return a.results[0].id},fetchCodes=async t=>{let e,r;(t.source="neurips")?r=t.title:e=t.id;const a=await fetchPWCId(e,r);if(!a)return[];let i=`https://paperswithcode.com/api/v1/papers/${a}/repositories/?`;i+=new URLSearchParams({page:1,items_per_page:10});const n=await fetch(i),s=await n.json();if(s.count<1)return;let c=s.results;return c.sort((t,e)=>t.stars-e.stars),c.slice(0,5)};