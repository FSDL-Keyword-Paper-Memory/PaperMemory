var global={};"undefined"!=typeof window&&(global=window),global.state={dataVersion:0,memoryIsOpen:!1,menuIsOpen:!1,papers:{},papersList:[],paperTags:new Set,pdfTitleFn:null,showFavorites:!1,sortedPapers:[],sortKey:"",papersReady:!1,theme:"light",memoryItemStyle:{}},global.darkTheme={background:"#1C2128",color:"#ADBAC7",noteColor:"#9aa4ae",dimColor:"#768390",buttonBackground:"#373E47",lighterBackground:"#22272E",codeBackground:"#5a5a5a",aColor:"#539BF5",memoryItem:{}},global.darkTheme.memoryItem={title:`style="color: ${global.darkTheme.color};"`,tagHTML:`style="color: ${global.darkTheme.color}; background: ${global.darkTheme.codeBackground}"`,author:`style="color: ${global.darkTheme.dimColor}"`,id:`style="color: ${global.darkTheme.dimColor}"`,visits:`style="color: ${global.darkTheme.dimColor}"`,note:`style="color: ${global.darkTheme.noteColor}"`,link:`style="color: ${global.darkTheme.aColor}"`,container:`style="border-color: ${global.darkTheme.buttonBackground}"`,input:`style="color: ${global.darkTheme.color}; background: ${global.darkTheme.lighterBackground}"`,button:`style="background: ${global.darkTheme.buttonBackground}"`,deleteRound:`style="background: ${global.darkTheme.background}"`},global.descendingSortKeys=["addDate","count","lastOpenDate","favoriteDate"],global.select2Options={placeholder:"Tag paper...",maximumSelectionLength:5,allowClear:!0,tags:!0,tokenSeparators:[","," "]},global.menuCheckNames=["checkBib","checkMd","checkDownload","checkPdfTitle","checkVanity","checkFeedback","checkColorTheme"],global.menuStorageKeys=[...global.menuCheckNames,"pdfTitleFn"],global.knownPaperPages={arxiv:["arxiv.org/pdf/","arxiv.org/abs/"],neurips:["neurips.cc/paper/"],cvf:["openaccess.thecvf.com/content"]},global.englishStopWords=new Set([["i","me","my","myself","we","our","ours","ourselves","you","your","yours","yourself","yourselves","he","him","his","himself","she","her","hers","herself","it","its","itself","they","them","their","theirs","themselves","what","which","who","whom","this","that","these","those","am","is","are","was","were","be","been","being","have","has","had","having","do","does","did","doing","a","an","the","and","but","if","or","because","as","until","while","of","at","by","for","with","about","against","between","into","through","during","before","after","above","below","to","from","up","down","in","out","on","off","over","under","again","further","then","once","here","there","when","where","why","how","all","any","both","each","few","more","most","other","some","such","no","nor","not","only","own","same","so","than","too","very","s","t","can","will","just","don","should","now"]]),$.easing.jswing=$.easing.swing,$.extend($.easing,{def:"easeOutQuad",swing:(e,t,a,o,n)=>$.easing[$.easing.def](e,t,a,o,n),easeInQuad:(e,t,a,o,n)=>o*(t/=n)*t+a,easeOutQuad:(e,t,a,o,n)=>-o*(t/=n)*(t-2)+a,easeInOutQuad:(e,t,a,o,n)=>(t/=n/2)<1?o/2*t*t+a:-o/2*(--t*(t-2)-1)+a,easeInCubic:(e,t,a,o,n)=>o*(t/=n)*t*t+a,easeOutCubic:(e,t,a,o,n)=>o*((t=t/n-1)*t*t+1)+a,easeInOutCubic:(e,t,a,o,n)=>(t/=n/2)<1?o/2*t*t*t+a:o/2*((t-=2)*t*t+2)+a,easeInQuart:(e,t,a,o,n)=>o*(t/=n)*t*t*t+a,easeOutQuart:(e,t,a,o,n)=>-o*((t=t/n-1)*t*t*t-1)+a,easeInOutQuart:(e,t,a,o,n)=>(t/=n/2)<1?o/2*t*t*t*t+a:-o/2*((t-=2)*t*t*t-2)+a,easeInQuint:(e,t,a,o,n)=>o*(t/=n)*t*t*t*t+a,easeOutQuint:(e,t,a,o,n)=>o*((t=t/n-1)*t*t*t*t+1)+a,easeInOutQuint:(e,t,a,o,n)=>(t/=n/2)<1?o/2*t*t*t*t*t+a:o/2*((t-=2)*t*t*t*t+2)+a,easeInSine:(e,t,a,o,n)=>-o*Math.cos(t/n*(Math.PI/2))+o+a,easeOutSine:(e,t,a,o,n)=>o*Math.sin(t/n*(Math.PI/2))+a,easeInOutSine:(e,t,a,o,n)=>-o/2*(Math.cos(Math.PI*t/n)-1)+a,easeInExpo:(e,t,a,o,n)=>0==t?a:o*Math.pow(2,10*(t/n-1))+a,easeOutExpo:(e,t,a,o,n)=>t==n?a+o:o*(1-Math.pow(2,-10*t/n))+a,easeInOutExpo:(e,t,a,o,n)=>0==t?a:t==n?a+o:(t/=n/2)<1?o/2*Math.pow(2,10*(t-1))+a:o/2*(2-Math.pow(2,-10*--t))+a,easeInCirc:(e,t,a,o,n)=>-o*(Math.sqrt(1-(t/=n)*t)-1)+a,easeOutCirc:(e,t,a,o,n)=>o*Math.sqrt(1-(t=t/n-1)*t)+a,easeInOutCirc:(e,t,a,o,n)=>(t/=n/2)<1?-o/2*(Math.sqrt(1-t*t)-1)+a:o/2*(Math.sqrt(1-(t-=2)*t)+1)+a,easeInElastic:(e,t,a,o,n)=>{var r=1.70158,s=0,l=o;if(0==t)return a;if(1==(t/=n))return a+o;if(s||(s=.3*n),l<Math.abs(o)){l=o;r=s/4}else r=s/(2*Math.PI)*Math.asin(o/l);return-l*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/s)+a},easeOutElastic:(e,t,a,o,n)=>{var r=1.70158,s=0,l=o;if(0==t)return a;if(1==(t/=n))return a+o;if(s||(s=.3*n),l<Math.abs(o)){l=o;r=s/4}else r=s/(2*Math.PI)*Math.asin(o/l);return l*Math.pow(2,-10*t)*Math.sin((t*n-r)*(2*Math.PI)/s)+o+a},easeInOutElastic:(e,t,a,o,n)=>{var r=1.70158,s=0,l=o;if(0==t)return a;if(2==(t/=n/2))return a+o;if(s||(s=n*(.3*1.5)),l<Math.abs(o)){l=o;r=s/4}else r=s/(2*Math.PI)*Math.asin(o/l);return t<1?l*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/s)*-.5+a:l*Math.pow(2,-10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/s)*.5+o+a},easeInBack:(e,t,a,o,n,r)=>(null==r&&(r=1.70158),o*(t/=n)*t*((r+1)*t-r)+a),easeOutBack:(e,t,a,o,n,r)=>(null==r&&(r=1.70158),o*((t=t/n-1)*t*((r+1)*t+r)+1)+a),easeInOutBack:(e,t,a,o,n,r)=>(null==r&&(r=1.70158),(t/=n/2)<1?o/2*(t*t*((1+(r*=1.525))*t-r))+a:o/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+a),easeInBounce:(e,t,a,o,n)=>o-$.easing.easeOutBounce(e,n-t,0,o,n)+a,easeOutBounce:(e,t,a,o,n)=>(t/=n)<1/2.75?o*(7.5625*t*t)+a:t<2/2.75?o*(7.5625*(t-=1.5/2.75)*t+.75)+a:t<2.5/2.75?o*(7.5625*(t-=2.25/2.75)*t+.9375)+a:o*(7.5625*(t-=2.625/2.75)*t+.984375)+a,easeInOutBounce:(e,t,a,o,n)=>t<n/2?.5*$.easing.easeInBounce(e,2*t,0,o,n)+a:.5*$.easing.easeOutBounce(e,2*t-n,0,o,n)+.5*o+a});const defaultPDFTitleFn=(e,t)=>(e=e.replaceAll("\n"," ").replace(/\s\s+/g," "),`${e} - ${t}.pdf`),delay=(e,t)=>{let a=0;return(...o)=>{clearTimeout(a),a=setTimeout(e.bind(this,...o),t||0)}},cleanPapers=e=>{let t={...e};return delete t.__dataVersion,t},fallbackCopyTextToClipboard=e=>{var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{var a=document.execCommand("copy"),o=a?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+o)}catch(e){console.error("Fallback: Oops, unable to copy",e)}document.body.removeChild(t)},copyTextToClipboard=e=>{navigator.clipboard?navigator.clipboard.writeText(e).then(()=>{console.log("Async: Copying to clipboard was successful!")},e=>{console.error("Async: Could not copy text: ",e)}):fallbackCopyTextToClipboard(e)},parseUrl=e=>{var t=document.createElement("a");return t.href=e,t},downloadTextFile=(e,t,a)=>{var o=document.createElement("a"),n=new Blob([e],{type:a});o.href=URL.createObjectURL(n),o.download=t,o.click()},eventId=e=>e.target.closest(".memory-item-container").id.split("--")[1],downloadFile=(e,t)=>{if(window.ActiveXObject){if(window.ActiveXObject&&document.execCommand){var a=window.open(e,"_blank");a.document.close(),a.document.execCommand("SaveAs",!0,t||e),a.close()}}else{var o=document.createElement("a");o.href=e,o.target="_blank";var n=e.substring(e.lastIndexOf("/")+1);if(o.download=t||n,navigator.userAgent.toLowerCase().match(/(ipad|iphone|safari)/)&&navigator.userAgent.search("Chrome")<0)document.location=o.href;else{var r=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});o.dispatchEvent(r),(window.URL||window.webkitURL).revokeObjectURL(o.href)}}},getPdfFn=code=>{try{pdfTitleFn=eval(code)}catch(e){console.log("Error parsing pdf title function. Function string then error:"),console.log(code),console.log(e),pdfTitleFn=defaultPDFTitleFn}try{pdfTitleFn("test","1.2")}catch(e){console.log("Error testing the user's pdf title function. Function string then error:"),console.log(code),console.log(e),pdfTitleFn=defaultPDFTitleFn}return pdfTitleFn},migrateData=async(e,t)=>{if(void 0===e)return chrome.storage.local.set({papers:{__dataVersion:t}}),{papers:{__dataVersion:t},success:!0};const a=e.__dataVersion||-1;var o=[];try{if(e.hasOwnProperty("__dataVersion")&&e.__dataVersion===t)return{papers:e,success:!0};backupData({...e}),delete e.__dataVersion;for(const t in e){if(a<5&&(e[t].hasOwnProperty("bibtext")||(e[t].bibtext="",console.log("Migrating bibtext for "+t)),e[t].pdfLink.endsWith(".pdf")||(e[t].pdfLink=e[t].pdfLink+".pdf"),e[t].codeLink||(e[t].codeLink=""),e[t].source||(e[t].id.includes("NeurIPS")?e[t].source="neurips":e[t].source="arxiv")),a<208&&("arxiv"!==e[t].source&&e[t].md.includes("https://arxiv.com/abs/")&&(e[t].md=`[${e[t].title}](${e[t].pdfLink})`),"arxiv"!==e[t].source&&e[t].pdfLink.includes("arxiv.org/pdf/")&&(e[t].source="arxiv"),t.match(/^\d/)&&"arxiv"===e[t].source)){const a=`Arxiv-${t}`;let n={...e[t],id:a};e[a]=n,o.push(t)}if(a<209&&(e[t].hasOwnProperty("favorite")||(e[t].favorite=!1,e[t].favoriteDate="")),a<210&&"arxiv"===e[t].source){const a=e[t].pdfLink.match(/v\d+\.pdf/gi);a&&a.length>0&&(e[t].pdfLink=e[t].pdfLink.replace(a[0],".pdf"))}}o.forEach((t,a)=>{delete e[t],console.log("Deleting "+t)});let n={...e};return n.__dataVersion=t,chrome.storage.local.set({papers:n},()=>{console.log("Migrated papers:"),console.log(n),console.log("Data version is now "+t)}),{papers:n,success:!0}}catch(e){return console.log(`Error migrating data from version ${a} to ${t}: `),console.log(e),{papers:n,success:!1}}},logStorage=e=>{chrome.storage.local.get(e,t=>{console.log(t[e])})},getStorage=async e=>new Promise((t,a)=>{chrome.storage.local.get(e,a=>{t("string"==typeof e?a[e]:a)})}),setStorage=async(e,t)=>new Promise((a,o)=>{chrome.storage.local.set({[e]:t},()=>{a(!0)})}),getTheme=async()=>{const e=await getStorage("checkColorTheme");return(void 0===e||e)&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"},backupData=async e=>{chrome.storage.local.get("papersBackup",({papersBackup:t})=>{void 0===t&&(t={});const a=Object.keys(t).map(e=>parseInt(e)).sort((e,t)=>e<t?1:-1).slice(4);for(const e of a)delete t[e];t[e.__dataVersion]=e,chrome.storage.local.set({papersBackup:t},()=>{console.log("Backed up data with version: "+e.__dataVersion)})})},statePdfTitle=(e,t)=>{let a;try{a=global.state.pdfTitleFn(e,t)}catch(o){console.log("statePdfTitle error",o),a=defaultPDFTitleFn(e,t)}return a.replaceAll("\n"," ").replace(/\s\s+/g," ")},manifestDataVersion=()=>{const e=chrome.runtime.getManifest();return e.version.split(".").map((e,t)=>parseInt(e)*10**(4-2*t)).reduce((e,t)=>e+t)},initState=async(e,t)=>{const a=Date.now();void 0===e&&(e=await getStorage("papers"),console.log("Time to retrieve stored papers (s): "+(Date.now()-a)/1e3)),console.log("Found papers:",e),global.state.dataVersion=manifestDataVersion(),global.state.pdfTitleFn=defaultPDFTitleFn;const o=Date.now(),n=await migrateData(e,global.state.dataVersion);if(console.log("Migration duration (s): "+(Date.now()-o)/1e3),e=n.papers,t)return console.log("State initialization duration (s): "+(Date.now()-a)/1e3),e;if(global.state.papers=e,global.state.papersList=Object.values(cleanPapers(e)),global.state.sortKey="lastOpenDate",global.state.papersReady=!0,sortMemory(),makeTags(),global.state.theme=await getTheme(),"dark"===global.state.theme)global.state.memoryItemStyle=global.darkTheme.memoryItem;else{global.state.memoryItemStyle={};for(const e in global.darkTheme.memoryItem)global.state.memoryItemStyle[e]=""}console.log("State initialization duration (s): "+(Date.now()-a)/1e3)},hashCode=e=>e.split("").reduce((e,t)=>(e=(e<<5)-e+t.charCodeAt(0),e&e),0),parseCVFUrl=e=>{const t=e.replace("https://openaccess.thecvf.com/content","").slice(1).split("/")[0].split("_");let a,o;1===t.length?(a=t[0].slice(0,-4),o=t[0].slice(-4)):(a=t[0].toUpperCase(),o=t[1]);const n=e.split("/").reverse()[0].split(".")[0],r=(hashCode(n)+"").replace("-","").slice(0,8),s=`${a}-${o}_${r}`;return{conf:a,year:o,id:s}},isPaper=e=>{parseUrl(e);let t={};for(const a in global.knownPaperPages){const o=global.knownPaperPages[a];t[a]=!1;for(const n of o)e.includes(n)&&(t[a]=!0)}return t},parseIdFromUrl=e=>{const t=isPaper(e);if(t.arxiv){const t=e.split("/").reverse()[0].replace(".pdf","").split("v")[0];return`Arxiv-${t}`}if(t.neurips){const t=e.split("/paper/")[1].split("/")[0],a=e.split("/").reverse()[0].split("-")[0].slice(0,8);return`NeurIPS-${t}_${a}`}if(t.cvf)return parseCVFUrl(e).id;throw Error("unknown paper url")},handlePopupKeydown=e=>{const t=e.key;if(["Backspace","Enter","Escape","a","e"].indexOf(t)<0)return;if(global.state.menuIsOpen)return void("Escape"===t&&(e.preventDefault(),closeMenu()));if(!global.state.memoryIsOpen){if("a"===t){const e=document.querySelectorAll(":focus");if(e&&e.length&&Array.from(e).some(e=>hasClass(e,"noMemoryOnA")))return;dispatch("memory-switch","click")}else if("Enter"===t){let e=document.querySelector("#memory-switch-text-on:focus");if(e)return void dispatch("memory-switch","click");if(e=document.querySelector("#tabler-menu:focus"),e)return dispatch("tabler-menu","click"),void dispatch("tabler-menu","blur")}return}if("Enter"===t){const e=document.querySelector("#filter-favorites:focus");if(e)return void dispatch("filter-favorites","click");const a=document.querySelector("#memory-sort-arrow:focus");if(a&&"Enter"===t)return void dispatch("memory-sort-arrow","click")}let a;const o=document.querySelector(".memory-item-container:focus");if("Escape"!==t){if(!o)return;a=o.id.split("--")[1]}"Backspace"===t?dispatch(findEl(a,"delete-memory-item"),"click"):"Enter"===t?dispatch(findEl(a,"memory-item-link"),"click"):"Escape"===t?(e.preventDefault(),closeMemory()):"e"===t&&dispatch(findEl(a,"memory-item-edit"),"click")},textareaFocusEnd=e=>{setTimeout(()=>{e.selectionStart=e.selectionEnd=1e4},0)},formatBibtext=e=>{let t=e.trim().split("\n").join("");const a=t.match(/\w+\ ?=/g);if(a)for(const e of a)t=t.replace(e,`\n  ${e}`);return"}}"===t.slice(-2)&&(t=t.slice(0,-1)+"\n}"),t},validatePaper=e=>{const t=["addDate","author","bibtext","codeLink","count","favorite","favoriteDate","id","key","lastOpenDate","md","note","pdfLink","source","tags","year"];let a=!1;for(const o of t)e.hasOwnProperty(o)||(a=!0,console.warn(`Key ${o} absent from paper ${e}`));const o=Object.keys(global.knownPaperPages);return o.indexOf(e.source)<0&&(a=!0,console.warn(`Unknown source ${e.source} for paper ${e}`)),a},tablerSvg=(e,t,a)=>{switch(void 0===t&&(t=""),void 0===a&&(a=[]),t&&(t=`id="${t}"`),a=a.filter(e=>e),a&&(a=`class="${a.join(" ")}"`),e){case"adjustments":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n            <circle cx="6" cy="10" r="2" />\n            <line x1="6" y1="4" x2="6" y2="8" />\n            <line x1="6" y1="12" x2="6" y2="20" />\n            <circle cx="12" cy="16" r="2" />\n            <line x1="12" y1="4" x2="12" y2="14" />\n            <line x1="12" y1="18" x2="12" y2="20" />\n            <circle cx="18" cy="7" r="2" />\n            <line x1="18" y1="4" x2="18" y2="5" />\n            <line x1="18" y1="9" x2="18" y2="20" />\n            </svg>`;case"circle-x":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n            <circle cx="12" cy="12" r="9" />\n            <path d="M10 10l4 4m0 -4l-4 4" />\n            </svg>`;case"star":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n            <path d="M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z" />\n            </svg>`;case"writing":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n            <path d="M20 17v-12c0 -1.121 -.879 -2 -2 -2s-2 .879 -2 2v12l2 2l2 -2z" />\n            <path d="M16 7h4" />\n            <path d="M18 19h-13a2 2 0 1 1 0 -4h4a2 2 0 1 0 0 -4h-3" />\n            </svg>`;case"file-symlink":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n            <path d="M4 21v-4a3 3 0 0 1 3 -3h5" />\n            <path d="M9 17l3 -3l-3 -3" />\n            <path d="M14 3v4a1 1 0 0 0 1 1h4" />\n            <path d="M5 11v-6a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-9.5" />\n            </svg>`;case"link":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n            <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />\n            <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />\n            </svg>`;case"clipboard-list":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n            <path d="M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2" />\n            <rect x="9" y="3" width="6" height="4" rx="2" />\n            <line x1="9" y1="12" x2="9.01" y2="12" />\n            <line x1="13" y1="12" x2="15" y2="12" />\n            <line x1="9" y1="16" x2="9.01" y2="16" />\n            <line x1="13" y1="16" x2="15" y2="16" />\n            </svg>`;case"archive":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n            <rect x="3" y="4" width="18" height="4" rx="2" />\n            <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />\n            <line x1="10" y1="12" x2="14" y2="12" />\n            </svg>`;case"external-link":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n            <path d="M11 7h-5a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-5" />\n            <line x1="10" y1="14" x2="20" y2="4" />\n            <polyline points="15 4 20 4 20 9" />\n            </svg>`;case"file-download":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n            <path d="M14 3v4a1 1 0 0 0 1 1h4" />\n            <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />\n            <line x1="12" y1="11" x2="12" y2="17" />\n            <polyline points="9 14 12 17 15 14" />\n             </svg>`;case"cirlce-x":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n\t\t\t<path stroke="none" d="M0 0h24v24H0z" fill="none" />\n\t\t\t<circle cx="12" cy="12" r="9" />\n\t\t\t<path d="M10 10l4 4m0 -4l-4 4" />\n\t\t    </svg>`;case"settings":return`<svg viewBox="0 0 24 24" ${t} ${a}>\n            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>\n            <path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" />\n            <circle cx="12" cy="12" r="3" />\n            </svg>`;case"external-link":default:return""}},loadJSONToMemory=async e=>{let t=!0,a=!1,o="";try{const n=JSON.parse(e);n.__dataVersion||(n.__dataVersion=1);const r=await migrateData(n,manifestDataVersion());if(!r.success)return void alert("Bug");const{papers:s}=r;for(const e in s)e.startsWith("__")||(paperWarning=validatePaper(s[e]),paperWarning&&(a=!0));if(a){const e=await getStorage("papers");setStorage("uploadBackup",e)}setStorage("papers",s),t=!1}catch(e){console.log("loadJSONToMemory error",t),o=e}return{success:t,message:o}},arraysIdentical=(e,t)=>{var a=e.length;if(a!=t.length)return!1;for(;a--;)if(e[a]!==t[a])return!1;return!0},parseTags=e=>{let t=Array.from(e.selectedOptions,e=>e.value.trim()).filter(e=>e);return t.sort(),t},getPaperEdits=(e,t)=>{let a,o,n,r;return t?(a=val(`popup-form-note-textarea--${e}`),n=val(document.getElementById(`popup-form-note--${e}`).querySelector(".form-code-input")),o=parseTags(document.getElementById(`popup-item-tags--${e}`)),r=document.getElementById(`checkFavorite--${e}`).checked):(a=val(findEl(e,"form-note-textarea")),n=val(findEl(e,"form-code-input")),o=parseTags(findEl(e,"memory-item-tags")),r=hasClass(`memory-item-container--${e}`,"favorite")),{note:a,tags:o,codeLink:n,favorite:r}},setFormChangeListener=(e,t)=>{let a,o,n,r;t?(a=`#popup-item-tags--${e.replace(".","\\.")}`,n=`popup-form-codeLink--${e}`,o=`popup-form-note-textarea--${e}`,r=`checkFavorite--${e}`,$(a).on("change",monitorPaperEdits(e,t)),addListener(n,"keyup",monitorPaperEdits(e,t)),addListener(o,"keyup",monitorPaperEdits(e,t)),addListener(r,"change",monitorPaperEdits(e,t))):(a=".memory-item-tags",n=".form-code-input",o=".form-note-textarea",addEventToClass(n,"keyup",monitorPaperEdits(e,t)),addEventToClass(o,"keyup",monitorPaperEdits(e,t)))},monitorPaperEdits=(e,t)=>a=>{void 0===e&&(e=eventId(a));const o=getPaperEdits(e,t),n=global.state.papers[e];let r,s=!1,l={};for(const e in o){const t=n[e];l[e]=t;const a=o[e];"tags"!==e||arraysIdentical(t,a)?"tags"!==e&&t!==a&&(s=!0):s=!0}r=t?document.getElementById(`popup-save-edits--${e}`):findEl(e,"memory-item-save-edits"),r.disabled=!s},cutAuthors=(e,t,a)=>{void 0===t&&(t=140),void 0===a&&(a=", ");let o="";const n=e.split(" and "),r=n[n.length-1];for(const e of n){if(!(5+o.length+a.length+e.length+r.length<t)){o+=" ... "+r;break}o?o+=", "+e:o=e}return o},val=(e,t)=>{if(e instanceof HTMLInputElement&&"checkbox"===e.type){if(void 0===t)return e.checked;e.checked=t}if("string"==typeof e&&(e=document.getElementById(e)),void 0===t)return e?e.value:"";e&&(e.value=t)},showId=(e,t)=>{void 0===t&&(t="block");let a=document.getElementById(e);a&&(a.style.display=t)},hideId=e=>{el=document.getElementById(e),el&&(el.style.display="none")},setTextId=(e,t)=>{let a=document.getElementById(e);a&&(a.innerText=t)},setHTMLEl=(e,t)=>{"string"==typeof e&&(e=document.getElementById(e)),e&&(e.innerHTML=t)},dispatch=(e,t)=>{if("string"==typeof e&&(e=document.getElementById(e)),"string"==typeof t){if("focus"===t)return void e.focus();t=new Event(t)}e.dispatchEvent(t)},hasClass=(e,t)=>{let a;if(a="string"==typeof e?document.getElementById(e):e,a)return a.classList.contains(t)},addClass=(e,t)=>{let a;a="string"==typeof e?document.getElementById(e):e,a&&a.classList.add(t)},removeClass=(e,t)=>{let a;a="string"==typeof e?document.getElementById(e):e,a&&a.classList.remove(t)},addListener=(e,t,a)=>{"string"==typeof e&&(e=document.getElementById(e)),e&&e.addEventListener(t,a)},setPlaceholder=(e,t)=>{"string"==typeof e&&(e=document.getElementById(e)),e&&void 0!==e.placeholder&&(e.placeholder=t)},setStyle=(e,t,a)=>{"string"==typeof e&&(e=document.getElementById(e)),e&&(e.style[t]=a,console.log(e,t,a))};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};const firstNonStopLowercase=e=>{let t=e.toLowerCase(),a=t.split(" ").map(e=>e.replace(/[^0-9a-z]/gi,"")),o=a.filter(e=>global.englishStopWords.has(e));return o.length>0?o[0]:a[0]},parseArxivBibtex=e=>{var t=$(e),a=[],o="";t.find("author name").each((e,t)=>{a.push($(t).text()),0===e&&(o+=$(t).text().split(" ")[$(t).text().split(" ").length-1].toLowerCase())});var n="";t.find("link").each((e,t)=>{const a=$(t).attr("href");a&&a.indexOf("arxiv.org/pdf/")>=0&&(n=a)});const r=n.match(/v\d+\.pdf/gi);r&&r.length>0&&(n=n.replace(r[0],".pdf"));const s=a.join(" and "),l=$(t.find("entry title")[0]).text(),i=$(t.find("entry published")[0]).text().slice(0,4);let c;o+=i,o+=firstNonStopLowercase(l);const d=t.find("id");d.each((e,t)=>{$(t).html().match(/\d\d\d\d\.\d\d\d\d\d/g)&&(c=$(t).html().match(/\d\d\d\d\.\d\d\d\d\d/g)[0])}),c=`Arxiv-${c}`;const p={key:o,title:l,author:s,year:i,id:c,pdfLink:n};let h="";return h+=`@article{${o}, \n`,h+=`    title = { ${l} }, \n`,h+=`    author = { ${s} }, \n`,h+=`    year = { ${i}}, \n`,h+=`    journal = { arXiv preprint arXiv: ${c}}\n`,h+="}",{bibvars:p,bibtext:h}},parseNeuripsHTML=(e,t)=>{const a=(new DOMParser).parseFromString(t.replaceAll("\n",""),"text/html"),o=$(a),n=o.find(".container-fluid .col p"),r=e.split("/").slice(-1)[0].replace("-Paper.pdf",""),s=o.find("h4").first().text(),l=$(n[1]).text().split(", ").map((e,t)=>{const a=e.split(" "),o=a.map((e,t)=>e.capitalize());return o.join(" ")}).join(" and "),i=e,c=$(n[0]).text().match(/\d{4}/)[0],d=`neurips${c}${r.slice(0,8)} `,p=`NeurIPS - ${c}_${r.slice(0,8)} `,h=`\n@inproceedings{NEURIPS${c}_${r.slice(0,8)}\n    author = { ${l}\n},\nbooktitle = { Advances in Neural Information Processing Systems },\n    editor = { H.Larochelle and M.Ranzato and R.Hadsell and M.F.Balcan and H.Lin },\n    publisher = { Curran Associates, Inc.},\n    title = { ${s}},\nurl = { ${e}},\nyear = { ${c}}\n}`;return{key:d,title:s,author:l,year:c,id:p,pdfLink:i,bibtext:h}},parseCvfHTML=(e,t)=>{const a=(new DOMParser).parseFromString(t.replaceAll("\n",""),"text/html"),o=$(a),n=o.find("#papertitle").text().trim();let r=o.find("#authors i").first().text();r=r.split(",").map(e=>e.trim()).join(" and ");const{year:s,id:l,conf:i}=parseCVFUrl(e);let c="";e.endsWith(".pdf")?c=e:o.find("a").each((e,t)=>{if("pdf"===$(t).text()){let e=$(t).attr("href");e.startsWith("../")&&(e=e.replaceAll("../","")),e.startsWith("/")||(e="/"+e),c="http://openaccess.thecvf.com"+e}});const d=o.find(".bibref").first().text().replaceAll(",  ",",\n  "),p=d.split("{")[1].split(",")[0];return{key:p,title:n,author:r,year:s,id:l,pdfLink:c,bibtext:d,conf:i}},fetchArxivXML=async e=>(e+="",e=e.replace("Arxiv-",""),$.get("https://export.arxiv.org/api/query",{id_list:e})),fetchNeuripsHTML=async e=>{let t;return t=e.endsWith(".pdf")?e.replace("/file/","/hash/").replace("-Paper.pdf","-Abstract.html"):e,fetch(t).then(e=>e.text())},fetchCvfHTML=async e=>{let t,a;if(t=e.endsWith(".pdf")?e.replace("/papers_backup/","/papers/").replace("/papers/","/html/").replace(".pdf",".html"):e,a=await fetch(t).then(e=>e.ok?e.text():""),!a&&t.includes("thecvf.com/content_")){const{conf:o,year:n}=parseCVFUrl(e);t=t.replace(`/content_${o}_${n}/`,`/content_${o.toLowerCase()}_${n}/`),a=await fetch(t).then(e=>e.ok?e.text():"")}return a},fetchOpts={headers:{mode:"no-cors"}},fetchPWCId=async(e,t)=>{let a="https://paperswithcode.com/api/v1/papers/?";e?a+=new URLSearchParams({arxiv_id:e}):t&&(a+=new URLSearchParams({title:t}));const o=await $.getJSON(a);if(console.log({json:o}),1===o.count)return o.results[0].id},fetchCodes=async e=>{let t,a;(e.source="neurips")?a=e.title:t=e.id;const o=await fetchPWCId(t,a);if(!o)return[];let n=`https://paperswithcode.com/api/v1/papers/${o}/repositories/?`;n+=new URLSearchParams({page:1,items_per_page:10});const r=await fetch(n),s=await r.json();if(s.count<1)return;let l=s.results;return l.sort((e,t)=>e.stars-t.stars),l.slice(0,5)};